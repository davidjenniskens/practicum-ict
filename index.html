<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable=no"/>
    <title>Versterk je Geheugen</title>

    <!-- ✅ BASIS: A-Frame engine -->
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>

    <!-- 🌍 Extra componenten: movement, navmesh, enz. -->
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.6.0/dist/aframe-extras.min.js"></script>

    <!-- ⚙️ Physics: zwaartekracht en botsingen -->
    <script src="https://unpkg.com/@c-frame/aframe-physics-system@4.2.2/dist/aframe-physics-system.min.js"></script>

    <!-- 🌲 Omgeving: snel bos, woestijn, etc. genereren -->
    <script src="https://cdn.jsdelivr.net/npm/aframe-environment-component@1.5.0/dist/aframe-environment-component.min.js"></script>

    <!-- 🧩 Eigen componenten -->
    <script>
      // Component om controller inputs te luisteren
      AFRAME.registerComponent("input-listen", {
        init: function () {
          this.el.grip = false;
          this.el.addEventListener("triggerdown", (e) => {
            console.log("Trigger ingedrukt door:", e.target.id);
            this.el.grip = true;
          });
          this.el.addEventListener("triggerup", (e) => {
            console.log("Trigger losgelaten door:", e.target.id);
            this.el.grip = false;
          });
          
          this.el.addEventListener("gripdown", function (e) {
          //Setting grip flag as true.
          this.grip = true;
          
          //document.getElementById("text").setAttribute("value", "gripdown");
           console.log("gripdown", e.target.id);
        });
        //Grip Released
        this.el.addEventListener("gripup", function (e) {
          //Setting grip flag as false.
          this.grip = false;
          
          //document.getElementById("text").setAttribute("value", "gripup");
          console.log("gripdown", e.target.id);
        });
        },
      });

      // Scorebord en timer component
      AFRAME.registerComponent("score-timer", {
  schema: {
    duration: { type: 'int', default: 120 } // seconden
  },
  init: function () {
    const scene = this.el;
    let timeLeft = this.data.duration;

    // ⏱ Timer text
    const timerText = document.createElement("a-text");
    timerText.setAttribute("value", "Je hebt nog:\n" + timeLeft + " seconden");
    timerText.setAttribute("position", "0 5 -7");
    timerText.setAttribute("align", "center");
    timerText.setAttribute("anchor", "center");
    timerText.setAttribute("color", "white");
    timerText.setAttribute("scale", "2 2 2");
    scene.appendChild(timerText);

    // Achtergrondblok
    const bg = document.createElement("a-plane");
    bg.setAttribute("width", 2);       // passend bij tekst
    bg.setAttribute("height", 1);
    bg.setAttribute("color", "red");
    bg.setAttribute("position", "0 0 -0.05");
    bg.setAttribute("side", "double");
    timerText.appendChild(bg);

    // Gele border
    const border = document.createElement("a-plane");
    border.setAttribute("width", 2.1);
    border.setAttribute("height", 1.1);
    border.setAttribute("color", "yellow");
    border.setAttribute("position", "0 0 -0.06");
    timerText.appendChild(border);

    // Timer interval
    const timerInterval = setInterval(() => {
      timeLeft--;
      if (timeLeft >= 0) {
        timerText.setAttribute("value", "Je hebt nog:\n " + timeLeft + " seconden");
      }
      if (timeLeft <= 0) {
        clearInterval(timerInterval);
        alert("Tijd is om!");
      }
    }, 1000);
  }
});
    </script>
  </head>

  <body>
    <!-- 🌌 De VR-wereld -->
    <a-scene  physics="debug: false"
             environment="preset: forest; lighting: point; lightPosition: -5 10 0;"
             score-timer>
      
      <!-- 👤 Speler / camera rig -->
      <a-entity id="rig"
                movement-controls="constrainToNavMesh: true; controls: checkpoint, gamepad, keyboard, nipple;"
                position="0 0 0">
        
        <!-- 🎥 Camera -->
        <a-entity camera position="0 1.6 0" look-controls="pointerLockEnabled: true">
          <a-cursor></a-cursor>

          <!-- 🖐️ Linker controller -->
          <a-entity id="ctlL"
                    laser-controls="hand: left" input-listen raycaster="lineColor: blue; lineOpacity: 0.5; far:2"
                    input-listen>
          </a-entity>

          <!-- 🖐️ Rechter controller -->
          <a-entity id="ctlR"
                    laser-controls="hand: right" input-listen raycaster="lineColor: red; lineOpacity: 0.5; far:2"
                    input-listen>
          </a-entity>
        </a-entity>
      </a-entity>

      
      <a-assets>
        <a-asset-item id="navmesh" src="https://c-frame.github.io/aframe-extras/examples/assets/castle/Castle-navmesh.glb"></a-asset-item>
        <!-- <a-asset-item id="navmesh" src="images/Castle-navmesh.glb"></a-asset-item> -->
        <a-asset-item id="castle" src="https://c-frame.github.io/aframe-extras/examples/assets/castle/Castle.glb"></a-asset-item>
        <!-- <a-asset-item id="castle" src="images/Castle.glb"></a-asset-item> -->
        
        <img id="blauw" src="https://i.ibb.co/ZR50Bnzw/blauw.png"></img>
        <img id="blauw11" src="media/blauw11.png"></img>
        <img id="blauw18" src="media/blauw18.png"></img>
        <img id="blauw19" src="media/blauw19.png"></img>
        
        <img id="groen" src="https://i.ibb.co/4gD5Qm8D/groen.png"></img>
        <img id="groen0" src="media/groen0.png"></img>
        <img id="groen4" src="media/groen4.png"></img>
        <img id="groen5" src="media/groen5.png"></img>
        
        <img id="oranje" src="https://i.ibb.co/ZpL5ZTXg/oranje.png"></img>
        <img id="oranje65" src="media/oranje65.png"></img>
        <img id="oranje70" src="media/oranje70.png"></img>
        <img id="oranje90" src="media/oranje90.png"></img>

        <audio id="correct" src="media/correct.mp3"></audio>
        <audio id="incorrect" src="media/incorrect.mp3"></audio>
      
      </a-assets>
      
      <a-sphere class="sphere-1" src="#oranje" scale="0.5 0.5 0.5" static-body position="-5 0.5 -6"
      animation__position="property: position; dir: alternate; dur: 2000; easing: easeInOutSine; loop: true; to: -5 1.0 -6"
      animation__rotate="property: rotation; to: 0 -360 0; loop: true; dur: 4000; easing: linear"></a-sphere>
      
      <a-box position="-3 1.66 -7" src="#oranje65"  depth="0.25" height="0.25" width="0.4" static-body sound="src: #incorrect; on: click"
      animation="property: rotation; to: 0 45 0; loop: 1; dir: alternate; dur: 500; easing: linear; startEvents: click"></a-box>
      <a-box position="-3 1.33 -7" src="#oranje70" depth="0.25" height="0.25" width="0.4" static-body sound="src: #incorrect; on: click"
      animation="property: rotation; to: 0 45 0; loop: 1; dir: alternate; dur: 500; easing: linear; startEvents: click"></a-box>
      <a-box position="-3 1.00 -7" src="#oranje90" depth="0.25" height="0.25" width="0.4" static-body sound="src: #correct; on: click"
      animation="property: scale; to: 1.1 1.1 1.1; dur:500; easing: linear; startEvents:click"></a-box>


      <a-sphere class="sphere-2" src="#blauw" scale="0.5 0.5 0.5" static-body position="-5 0.5 6"
      animation__position="property: position; dir: alternate; dur: 2000; easing: easeInOutSine; loop: true; to: -5 1.0 6"
      animation__rotate="property: rotation; to: 0 -360 0; loop: true; dur: 4000; easing: easeInOutSine"></a-sphere>
      
      <a-box position="-3 1 7" src="#blauw11"  depth="0.25" height="0.25" width="0.4" static-body sound="src: #incorrect; on: click"
      animation="property: rotation; to: 0 -45 0; loop: 1; dir: alternate; dur: 500; easing: linear; startEvents: click"></a-box>
      <a-box position="-3 1.33 7" src="#blauw18" depth="0.25" height="0.25" width="0.4" static-body sound="src: #incorrect; on: click"
      animation="property: rotation; to: 0 -45 0; loop: 1; dir: alternate; dur: 500; easing: linear; startEvents: click"></a-box>
      <a-box position="-3 1.66 7" src="#blauw19" depth="0.25" height="0.25" width="0.4" static-body sound="src: #correct; on: click"
      animation="property: scale; to: 1.1 1.1 1.1; dur:500; easing: linear; startEvents:click"></a-box>


      <a-sphere class="sphere-3" src="#groen" scale="0.5 0.5 0.5" static-body position="4.15 6.7 -3"
      animation__position="property: position; dir: alternate; dur: 2000; easing: easeInOutSine; loop: true; to: 4.15 7.2 -3"
      animation__rotate="property: rotation; to: 0 -360 0; loop: true; dur: 4000; easing: linear"></a-sphere>
      
      <a-box position="2.90 7 -2" src="#groen0"  depth="0.25" height="0.25" width="0.4" static-body sound="src: #incorrect; on: click"
      animation="property: rotation; to: 0 45 0; loop: 1; dir: alternate; dur: 500; easing: linear; startEvents: click"></a-box>
      <a-box position="2.90 7.66 -2" src="#groen4" depth="0.25" height="0.25" width="0.4" static-body sound="src: #incorrect; on: click"
      animation="property: rotation; to: 0 45 0; loop: 1; dir: alternate; dur: 500; easing: linear; startEvents: click"></a-box>
      <a-box position="2.90 7.33 -2" src="#groen5" depth="0.25" height="0.25" width="0.4" static-body sound="src: #correct; on: click"
      animation="property: scale; to: 1.1 1.1 1.1; dur:500; easing: linear; startEvents:click"></a-box>


      <a-entity nav-mesh visible="false" position="4 0 0" gltf-model="#navmesh"></a-entity>

      <a-entity position="4 0 0" scale="3 3 3" gltf-model="#castle"></a-entity>
    </a-scene>
  </body>
</html>
