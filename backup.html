<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable=no"/>
    <title>Versterk je Geheugen</title>

    <!-- ✅ BASIS: A-Frame engine -->
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>

    <!-- 🌍 Extra componenten: movement, navmesh, enz. -->
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.6.0/dist/aframe-extras.min.js"></script>

    <!-- ⚙️ Physics: zwaartekracht en botsingen -->
    <script src="https://unpkg.com/@c-frame/aframe-physics-system@4.2.2/dist/aframe-physics-system.min.js"></script>

    <!-- 🌲 Omgeving: snel bos, woestijn, etc. genereren -->
    <script src="https://cdn.jsdelivr.net/npm/aframe-environment-component@1.5.0/dist/aframe-environment-component.min.js"></script>

    <!-- 🧩 Eigen componenten -->
    <script>
      // Component om controller inputs te luisteren
      AFRAME.registerComponent("input-listen", {
        init: function () {
          this.el.grip = false;
          this.el.addEventListener("triggerdown", (e) => {
            console.log("Trigger ingedrukt door:", e.target.id);
            this.el.grip = true;
          });
          this.el.addEventListener("triggerup", (e) => {
            console.log("Trigger losgelaten door:", e.target.id);
            this.el.grip = false;
          });
        },
      });

      // Scorebord en timer component
      AFRAME.registerComponent("score-timer", {
        schema: {
          initialScore: { type: 'int', default: 0 },
          duration: { type: 'int', default: 120 } // seconden
        },
        init: function () {
          const scene = this.el;
          let score = this.data.initialScore;
          let timeLeft = this.data.duration;

          // 🧮 Scorebord maken
          const scoreText = document.createElement("a-text");
          scoreText.setAttribute("value", "Score: " + score);
          scoreText.setAttribute("position", "0 5 -7");
          scoreText.setAttribute("align", "center");
          scoreText.setAttribute("anchor", "center");
          scoreText.setAttribute("side", "double");
          scoreText.setAttribute("color", "yellow");
          scoreText.setAttribute("scale", "3 3 3");
          scene.appendChild(scoreText);

          // Achtergrondblok
          const bg = document.createElement("a-plane");
          bg.setAttribute("width", 2);
          bg.setAttribute("height", 1);
          bg.setAttribute("color", "red");
          bg.setAttribute("position", "0 -0.15 -0.05");
          bg.setAttribute("side", "double");
          scoreText.appendChild(bg);

          // Gele rand
          const border = document.createElement("a-plane");
          border.setAttribute("width", 2.05);
          border.setAttribute("height", 1.05);
          border.setAttribute("color", "yellow");
          border.setAttribute("position", "0 -0.15 -0.06");
          scoreText.appendChild(border);

          // ⏱ Timer
          const timerText = document.createElement("a-text");
          timerText.setAttribute("value", "Time: " + timeLeft);
          timerText.setAttribute("position", "0 4 -7");
          timerText.setAttribute("align", "center");
          timerText.setAttribute("color", "white");
          timerText.setAttribute("scale", "2 2 2");
          scene.appendChild(timerText);

          const timerInterval = setInterval(() => {
            timeLeft--;
            timerText.setAttribute("value", "Time: " + timeLeft);
            if (timeLeft <= 0) {
              clearInterval(timerInterval);
              alert("Tijd is om! Je score: " + score);
            }
          }, 1000);

          // Functie om score bij te werken
          this.updateScore = function (points) {
            score += points;
            scoreText.setAttribute("value", "Score: " + score);
          };
        }
      });
    </script>
  </head>

  <body>
    <!-- 🌌 De VR-wereld -->
    <a-scene  physics="debug: true"
             environment="preset: forest; lighting: point; lightPosition: -5 10 0;"
             score-timer>
      
      <!-- 👤 Speler / camera rig -->
      <a-entity id="rig"
                movement-controls="constrainToNavMesh: true; controls: checkpoint, gamepad, keyboard, nipple;"
                position="0 0 0">
        
        <!-- 🎥 Camera -->
        <a-entity camera position="0 1.6 0" look-controls="pointerLockEnabled: true">
          <a-cursor></a-cursor>

          <!-- 🖐️ Linker controller -->
          <a-entity id="ctlL"
                    meta-touch-controls="hand: left"
                    input-listen>
          </a-entity>

          <!-- 🖐️ Rechter controller -->
          <a-entity id="ctlR"
                    meta-touch-controls="hand: right"
                    input-listen>
          </a-entity>
        </a-entity>
      </a-entity>

      <!-- 🌍 NavMesh & Model voorbeeld -->
      <a-assets>
        <a-asset-item id="navmesh" src="https://c-frame.github.io/aframe-extras/examples/assets/castle/Castle-navmesh.glb"></a-asset-item>
        <!-- <a-asset-item id="navmesh" src="images/Castle-navmesh.glb"></a-asset-item> -->
        <img id="blauw" src="https://i.ibb.co/ZR50Bnzw/blauw.png"></img>
        <img id="blauw11" src="images/blauw11.png"></img>
        <img id="blauw18" src="images/blauw18.png"></img>
        <img id="blauw19" src="images/blauw19.png"></img>
        
        <img id="groen" src="https://i.ibb.co/4gD5Qm8D/groen.png"></img>
        <img id="groen0" src="images/groen0.png"></img>
        <img id="groen4" src="images/groen4.png"></img>
        <img id="groen5" src="images/groen5.png"></img>
        
        <img id="oranje" src="https://i.ibb.co/ZpL5ZTXg/oranje.png"></img>
        <img id="oranje65" src="images/oranje65.png"></img>
        <img id="oranje70" src="images/oranje70.png"></img>
        <img id="oranje90" src="images/oranje90.png"></img>
        <a-asset-item id="castle" src="https://c-frame.github.io/aframe-extras/examples/assets/castle/Castle.glb"></a-asset-item>
        <!-- <a-asset-item id="castle" src="images/Castle.glb"></a-asset-item> -->
      </a-assets>
      <a-sphere class="sphere-1" src="#oranje" scale="0.5 0.5 0.5" static-body position="-5 0.5 -6"
      animation__position="property: position; dir: alternate; dur: 2000; easing: easeInOutSine; loop: true; to: -5 1.0 -6"
      animation__rotate="property: rotation; to: 0 -360 0; loop: true; dur: 4000; easing: linear"></a-sphere>
      <a-box position="-3 1 -7" src="#oranje65"  depth="0.25" height="0.25" width="0.4" static-body></a-box>
      <a-box position="-3 1.33 -7" src="#oranje70" depth="0.25" height="0.25" width="0.4" static-body></a-box>
      <a-box position="-3 1.66 -7" src="#oranje90" depth="0.25" height="0.25" width="0.4" dynamic-body></a-box>


      <a-sphere class="sphere-2" src="#blauw" scale="0.5 0.5 0.5" static-body position="-5 0.5 6"
      animation__position="property: position; dir: alternate; dur: 2000; easing: easeInOutSine; loop: true; to: -5 1.0 6"
      animation__rotate="property: rotation; to: 0 -360 0; loop: true; dur: 4000; easing: easeInOutSine"></a-sphere>
      <a-box position="-3 1 7" src="#blauw11"  depth="0.25" height="0.25" width="0.4" static-body></a-box>
      <a-box position="-3 1.33 7" src="#blauw18" depth="0.25" height="0.25" width="0.4" static-body></a-box>
      <a-box position="-3 1.66 7" src="#blauw19" depth="0.25" height="0.25" width="0.4" static-body></a-box>


      <a-sphere class="sphere-3" src="#groen" scale="0.5 0.5 0.5" static-body position="4.15 6.7 -3"
      animation__position="property: position; dir: alternate; dur: 2000; easing: easeInOutSine; loop: true; to: 4.15 7.2 -3"
      animation__rotate="property: rotation; to: 0 -360 0; loop: true; dur: 4000; easing: linear"></a-sphere>
      <a-box position="2.90 7 -2" src="#groen0"  depth="0.25" height="0.25" width="0.4" static-body></a-box>
      <a-box position="2.90 7.33 -2" src="#groen4" depth="0.25" height="0.25" width="0.4" static-body></a-box>
      <a-box position="2.90 7.66 -2" src="#groen5" depth="0.25" height="0.25" width="0.4" static-body></a-box>


      <a-entity nav-mesh visible="false" position="4 0 0" gltf-model="#navmesh"></a-entity>

      <a-entity position="4 0 0" scale="3 3 3" gltf-model="#castle"></a-entity>
    </a-scene>
  </body>
</html>